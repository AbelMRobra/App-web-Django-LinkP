{% extends "users/inicio2.html" %}

{% load static %}
{% load humanize %}

{% block content %}


<div class="container-fluid">

    <div class="row page-titles">
        <div class="col-md-5 align-self-center">
            <h3 class="text-themecolor">Resumen de las cuentas</h3>
        </div>

        <div class="col-md-7 align-self-center">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'Inicio' %}">Inicio</a></li>
                <li class="breadcrumb-item"><a href="{% url 'Panel cuentas corrientes' %}">Panel</a></li>
                <li class="breadcrumb-item">Resumen</li>
            </ol>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body row">
                <div class="col-12 justify-content-center">

                    <div class="row">
                        <div class="col-12">
                            <ul class="nav nav-tabs">
                                <li class="active"><a data-toggle="tab" href="#principal">Total</a></li>
                                <li><a data-toggle="tab" href="#proyecto">Proyecto</a></li>
                                <li><a data-toggle="tab" href="#link">Link</a></li>
                                <li><a data-toggle="tab" href="#terreno">Terreno</a></li>
                                <li><a data-toggle="tab" href="#principalb">Total (B)</a></li>
                                <li><a data-toggle="tab" href="#detalle">Detalle</a></li>

                            </ul>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-12">
                            <div class="tab-content">
                                <div id="principal" class="tab-pane fade in active">
                                    <div class="row">
                                        <div class="card-body overflow-auto">
                                            <h4 class="card-title"><span class="lstick"></span>
                                                Resumen general de los proyectos</h4>
                                            <h6 class="card-subtitle">Totalizadores</h6>

                                            <div>
                                                {% if proy %}
                                                <div>

                                                    <img src="{{proy.iamgen.url}}" class="img-fluid mb-4" alt="..."
                                                        style="max-width:200px;width:auto;height:auto; margin-top: 1rem;">

                                                </div>

                                                {% endif %}



                                                <table id="example" class="table table-striped table-bordered mt-4">
                                                    <thead>

                                                        <tr>
                                                            <th style="vertical-align: middle; width: 80px;">Proyecto</th>
                                                            <th style="vertical-align: middle; text-align: center;">Plan a hoy</th>
                                                            <th style="vertical-align: middle; text-align: center;">Cobrado</th>
                                                            <th style="vertical-align: middle; text-align: center;">Deuda</th>
                                                            <th style="vertical-align: middle; text-align: center;">Plan a final</th>
                                                        </tr>

                                                    </thead>

                                                    <tbody>

                                                        {% for i in data_project %}

                                                        <tr>
                                                            <td>
                                                                <h6 style="color: rgb({{i.0.color}});">{{i.0.nombre|lower|capfirst}}</h6><a href="{% url 'Descargar resumen proyecto' i.0.id %}"><i class="fa  fa-file-excel-o  text-success text-center"> </i></a>
                                                            </td>
                                                            <td class="text-center"> $ {{i.1.0|floatformat:0|intcomma}}<h6 class="card-subtitle text-center" style="margin-top: 5px;">{{i.2.0|floatformat:2}} M3</h6>
                                                            </td>
                                                            <td class="text-center"> $ {{i.3|floatformat:0|intcomma}}<h6 class="card-subtitle text-center" style="margin-top: 5px;">{{i.2.1|floatformat:2}} M3</h6>
                                                            </td>
                                                            <td class="text-center"> $ {{i.1.2|floatformat:0|intcomma}}<h6 class="card-subtitle text-center" style="margin-top: 5px;">{{i.2.2|floatformat:2}} M3</h6>
                                                            </td>
                                                            <td class="text-center"> $ {{i.1.3|floatformat:0|intcomma}}<h6 class="card-subtitle text-center" style="margin-top: 5px;">{{i.2.3|floatformat:2}} M3</h6>
                                                            </td>
                                                        </tr>

                                                        {% endfor %}

                                                        <tr>
                                                            <td style="vertical-align: middle;"></td>
                                                            <td style="vertical-align: middle; text-align: center;">${{array_total.0| floatformat:0|intcomma}}
                                                            <h6 class="card-subtitle text-center" style="margin-top: 5px;">{{array_total_h.0|floatformat:2}} M3</h6></td>
                                                            <td style="vertical-align: middle; text-align: center;">${{array_total.1|floatformat:0|intcomma}}
                                                            <h6 class="card-subtitle text-center" style="margin-top: 5px;">{{array_total_h.6|floatformat:2}} M3</h6></td>
                                                            <td style="vertical-align: middle; text-align: center;">${{array_total.2|floatformat:0|intcomma}}
                                                            <h6 class="card-subtitle text-center" style="margin-top: 5px;">{{array_total_h.2|floatformat:2}} M3</h6></td>
                                                            <td style="vertical-align: middle; text-align: center;">${{array_total.3|floatformat:0|intcomma}}
                                                            <h6 class="card-subtitle text-center" style="margin-top: 5px;">{{array_total_h.3|floatformat:2}} M3</h6></td>
                                                        </tr>
                                                    </tbody>
                                                </table>

                                                <small>* Cobrado es el valor nominal en pesos, plan a hoy es el valor en
                                                    moneda
                                                    dura por su cotización actual</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                               
                                <!--  -->

                                <div id="proyecto" class="tab-pane fade">
                                    <div class="row ">
                                        <div class="card-body overflow-auto">
                                            <h4 class="card-title"><span class="lstick"></span>
                                                Resumen proyectos</h4>
                                            <h6 class="card-subtitle">Totalizadores</h6>

                                            <div>
                                                {% if proy %}
                                                <div>

                                                    <img src="{{proy.iamgen.url}}" class="img-fluid mb-4" alt="..."
                                                        style="max-width:200px;width:auto;height:auto; margin-top: 1rem;">

                                                </div>

                                                {% endif %}


                                                <div class="">


                                                    <table id="example2" class="table table-striped table-bordered"
                                                        style="font-size: 14px;">
                                                        <thead>

                                                            <tr>
                                                                <th style="vertical-align: middle; width: 80px;">Proyecto</th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Plan a
                                                                    hoy</th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Cobrado*
                                                                </th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Deuda
                                                                </th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Plan a
                                                                    final</th>
                                                            </tr>


                                                        </thead>

                                                        <tbody>

                                                            {% for i in data_project_proyecto %}

                                                            <tr>
                                                                <td style="color: rgb({{i.0.color}});">
                                                                    {{i.0.nombre|lower|capfirst}}</td>
                                                                <td class="text-center"> $ {{i.1.0|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.0|floatformat:2}} M3</h6>
                                                                </td>
                                                                <td class="text-center"> $ {{i.3|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.1|floatformat:2}} M3</h6>
                                                                </td>
                                                                <td class="text-center"> $ {{i.1.2|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.2|floatformat:2}} M3</h6>
                                                                </td>
                                                                <td class="text-center"> $ {{i.1.3|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.3|floatformat:2}} M3</h6>
                                                                </td>


                                                            </tr>

                                                            {% endfor %}
                                                            <tr>
                                                                <td style="vertical-align: middle;"></td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    ${{array_total_proyecto.0|floatformat:0|intcomma}}
                                                                <h6 class="card-subtitle text-center" style="margin-top: 5px;">{{array_total_proyecto_h.0|floatformat:2}} M3</h6></td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    ${{array_total_proyecto.1|floatformat:0|intcomma}}
                                                                <h6 class="card-subtitle text-center" style="margin-top: 5px;">{{array_total_proyecto_h.6|floatformat:2}} M3</h6></td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    ${{array_total_proyecto.2|floatformat:0|intcomma}}
                                                                <h6 class="card-subtitle text-center" style="margin-top: 5px;">{{array_total_proyecto_h.2|floatformat:2}} M3</h6></td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    ${{array_total_proyecto.3|floatformat:0|intcomma}}
                                                                <h6 class="card-subtitle text-center" style="margin-top: 5px;">{{array_total_proyecto_h.3|floatformat:2}} M3</h6></td>
                                                            </tr>

                                                        </tbody>
                                                    </table>


                                                </div>


                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="link" class="tab-pane fade">
                                    <div class="row ">
                                        <div class="card-body overflow-auto">
                                            <h4 class="card-title"><span class="lstick"></span>
                                                Resumen Link</h4>
                                            <h6 class="card-subtitle">Totalizadores</h6>

                                            <div>
                                                {% if proy %}
                                                <div>

                                                    <img src="{{proy.iamgen.url}}" class="img-fluid mb-4" alt="..."
                                                        style="max-width:200px;width:auto;height:auto; margin-top: 1rem;">

                                                </div>

                                                {% endif %}

                                                <div class="">
                                                    <table id="example3" class="table table-striped table-bordered mt-1"
                                                        style="font-size: 14px;">
                                                        <thead>

                                                            <tr>
                                                                <th style="vertical-align: middle; width: 80px;">Proyecto</th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Plan a
                                                                    hoy</th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Cobrado*
                                                                </th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Deuda
                                                                </th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Plan a
                                                                    final</th>
                                                            </tr>


                                                        </thead>

                                                        <tbody>

                                                            {% for i in data_project_link %}

                                                            <tr>
                                                                <td style="color: rgb({{i.0.color}});">
                                                                    {{i.0.nombre|lower|capfirst}}</td>
                                                                <td class="text-center"> $ {{i.1.0|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.0|floatformat:3}} M3</h6>
                                                                </td>
                                                                <td class="text-center"> $ {{i.3|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.1|floatformat:3}} M3</h6>
                                                                </td>
                                                                <td class="text-center"> $ {{i.1.2|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.2|floatformat:3}} M3</h6>
                                                                </td>
                                                                <td class="text-center"> $ {{i.1.3|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.3|floatformat:3}} M3</h6>
                                                                </td>


                                                            </tr>

                                                            {% endfor %}

                                                            <tr>
                                                                <td style="vertical-align: middle;"></td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    $
                                                                    {{array_total_link.0|floatformat:0|intcomma}}</td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    $
                                                                    {{array_total_link.1|floatformat:0|intcomma}}</td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    $
                                                                    {{array_total_link.2|floatformat:0|intcomma}}</td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    $
                                                                    {{array_total_link.3|floatformat:0|intcomma}}</td>
                                                            </tr>
                                                        </tbody>

    
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="terreno" class="tab-pane fade">
                                    <div class="row ">
                                        <div class="card-body overflow-auto">
                                            <h4 class="card-title"><span class="lstick"></span>
                                                Resumen terrenos</h4>
                                            <h6 class="card-subtitle">Totalizadores</h6>

                                            <div>
                                                {% if proy %}
                                                <div>

                                                    <img src="{{proy.iamgen.url}}" class="img-fluid mb-4" alt="..."
                                                        style="max-width:200px;width:auto;height:auto; margin-top: 1rem;">

                                                </div>

                                                {% endif %}


                                                <div class="">


                                                    <table id="example4" class="table table-striped table-bordered mt-1"
                                                        style="font-size: 14px;">
                                                        <thead>

                                                            <tr>
                                                                <th style="vertical-align: middle; width: 80px;">Proyecto</th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Plan a
                                                                    hoy</th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Cobrado*
                                                                </th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Deuda
                                                                </th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Plan a
                                                                    final</th>
                                                            </tr>


                                                        </thead>

                                                        <tbody>

                                                            {% for i in data_project_terreno %}

                                                            <tr>
                                                                <td style="color: rgb({{i.0.color}});">
                                                                    {{i.0.nombre|lower|capfirst}}</td>
                                                                <td class="text-center"> $ {{i.1.0|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.0|floatformat:3}} M3</h6>
                                                                </td>
                                                                <td class="text-center"> $ {{i.3|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.1|floatformat:3}} M3</h6>
                                                                </td>
                                                                <td class="text-center"> $ {{i.1.2|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.2|floatformat:3}} M3</h6>
                                                                </td>
                                                                <td class="text-center"> $ {{i.1.3|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.3|floatformat:3}} M3</h6>
                                                                </td>


                                                            </tr>

                                                            {% endfor %}
                                                            
                                                            <tr>
                                                                <td style="vertical-align: middle;"></td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    $
                                                                    {{array_total_terreno.0|floatformat:0|intcomma}}</td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    $
                                                                    {{array_total_terreno.1|floatformat:0|intcomma}}</td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    $
                                                                    {{array_total_terreno.2|floatformat:0|intcomma}}</td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    $
                                                                    {{array_total_terreno.3|floatformat:0|intcomma}}</td>
                                                            </tr>

                                                        </tbody>

                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--  -->

                                <div id="principalb" class="tab-pane fade">
                                    <div class="row ">
                                        <div class="card-body overflow-auto">
                                            <h4 class="card-title"><span class="lstick"></span>
                                                Resumen general de los proyectos (boleto)</h4>
                                            <h6 class="card-subtitle">Totalizadores</h6>

                                            <div>
                                                {% if proy %}
                                                <div>

                                                    <img src="{{proy.iamgen.url}}" class="img-fluid mb-4" alt="..."
                                                        style="max-width:200px;width:auto;height:auto; margin-top: 1rem;">

                                                </div>

                                                {% endif %}


                                                <div class="">


                                                    <table id="example5" class="table table-striped table-bordered mt-1"
                                                        style="font-size: 14px;">
                                                        <thead>

                                                            <tr>
                                                                <th style="vertical-align: middle; width: 80px;">Proyecto</th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Plan a
                                                                    hoy</th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Cobrado*
                                                                </th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Deuda
                                                                </th>
                                                                <th style="vertical-align: middle; text-align: center;">
                                                                    Plan a
                                                                    final</th>
                                                            </tr>

                                                        </thead>

                                                        <tbody>

                                                            {% for i in data_project_b %}

                                                            <tr>
                                                                <td style="color: rgb({{i.0.color}});">
                                                                    {{i.0.nombre|lower|capfirst}}</td>
                                                                <td class="text-center"> $ {{i.1.0|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.0|floatformat:3}} M3</h6>
                                                                </td>
                                                                <td class="text-center"> $ {{i.3|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.1|floatformat:3}} M3</h6>
                                                                </td>
                                                                <td class="text-center"> $ {{i.1.2|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.2|floatformat:3}} M3</h6>
                                                                </td>
                                                                <td class="text-center"> $ {{i.1.3|floatformat:0|intcomma}}
                                                                    <h6 class="card-subtitle text-center" style="margin-top: 5px;">
                                                                        {{i.2.3|floatformat:3}} M3</h6>
                                                                </td>


                                                            </tr>

                                                            {% endfor %}
                                                            
                                                            <tr>
                                                                <td style="vertical-align: middle;"></td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    $
                                                                    {{array_b_total.0|floatformat:0|intcomma}}</td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    $
                                                                    {{array_b_total.1|floatformat:0|intcomma}}</td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    $
                                                                    {{array_b_total.2|floatformat:0|intcomma}}</td>
                                                                <td style="vertical-align: middle; text-align: center;">
                                                                    $
                                                                    {{array_b_total.3|floatformat:0|intcomma}}</td>
                                                            </tr>

                                                        </tbody>
    
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <div id="detalle" class="tab-pane fade">
                                    <div class="row ">

                                        <div class="card-body overflow-auto">
                                            <h4 class="card-title"><span class="lstick"></span>
                                                Detalle de las cuentas</h4>
                                            <h6 class="card-subtitle">Información general</h6>

                                            <div style="text-align: center;">

                                                {% if proy %}
                                                <div>

                                                    <img src="{{proy.iamgen.url}}" class="img-fluid mb-4" alt="..."
                                                        style="max-width:200px;width:auto;height:auto; margin-top: 1rem;">

                                                </div>

                                                {% endif %}

                                                <div>
                                                    <table id="example6" class="table table-striped table-bordered"
                                                        style="width:100%">
                                                        <thead>

                                                            <tr>
                                                                <th style="vertical-align: middle;">Cliente</th>
                                                                <th style="vertical-align: middle; text-align: center;">Proyecto </th>
                                                                <th style="vertical-align: middle; text-align: center;">Unidad </th>
                                                                <th style="vertical-align: middle; text-align: center;">Cobrado </th>
                                                                <th style="vertical-align: middle; text-align: center;">Adeudado</th>
                                                                <th style="vertical-align: middle; text-align: center;">Pendiente</th>
                                                                <th style="vertical-align: middle; text-align: center;">Hormigon</th>
                                                            </tr>

                                                        </thead>

                                                        <tbody>

                                                            {% for i in datos %}

                                                            <tr>
                                                                <td style="text-align: left;">
                                                                    <small>{{i.0.venta.comprador|lower|capfirst}}</small>
                                                                </td>
                                                                <td style="color: rgb({{i.0.venta.proyecto.color}});"><small><b>{{i.0.venta.proyecto}}</b></small>
                                                                </td>
                                                                <td> <small>{{i.0.venta.unidad.piso_unidad}} - {{i.0.venta.unidad.nombre_unidad}}</small>
                                                                </td>
                                                                <td> <small>$ {{i.1|floatformat:0|intcomma}}</small>
                                                                </td>
                                                                <td> <small>$ {{i.2|floatformat:0|intcomma}} </small>
                                                                </td>
                                                                <td> <small>$ {{i.3|floatformat:0|intcomma}} </small>
                                                                </td>
                                                                <td> <small>$ {{i.4|floatformat:0|intcomma}} </small>
                                                                </td>

                                                            </tr>

                                                            {% endfor %}

                                                        </tbody>

                                                    </table>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>



<script>
    $(document).ready(function () {
        $('#example').DataTable({
            "paging": false,
            "searching": false,
            "ordering": false,
            "info": false,

        });
    });
</script>


<script>
    $(document).ready(function () {
        $('#example2').DataTable({
            "paging": false,
            "info": false,
            "searching": false,
            "ordering": false,

        });
    });
</script>

    <script>
        $(document).ready(function () {
            $('#example3').DataTable({
                "paging": false,
                "searching": false,
                "info": false,
                "ordering": false,
    
            });
        });
    </script>
    <script>
        $(document).ready(function () {
            $('#example4').DataTable({
                "paging": false,
                "searching": false,
                "info": false,
                "ordering": false,
    
            });
        });
    </script>
    <script>
        $(document).ready(function () {
            $('#example5').DataTable({
                "paging": false,
                "searching": false,
                "info": false,
                "ordering": false,
    
            });
        });
    </script>


  <script>
    
      $(document).ready(function () {
          $('#example6').DataTable({
              "paging": false,
              "info": false,
              dom: 'Bfrtip',
              buttons: [
              {
                  extend: 'excelHtml5',
                  title: 'Resumen de cuentas'
              },
      ]
  
          });
      });
  </script>


{% endblock %}