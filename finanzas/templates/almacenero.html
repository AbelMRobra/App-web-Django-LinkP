{% extends "users/inicio.html" %}

{% load static %}
{% load humanize %}

{% block content %}



<div class = "jumbotron" style="background-color: white; margin-bottom: 0px; text-align: center;" > 

    <div style="text-align: center;">

        <h2 style="font-family: Arial, Helvetica, sans-serif;">Analisis de proyectos</h2>

        <small style="font-family: Arial, Helvetica, sans-serif;" > <b>Modulo:</b> Finanzas</small>

        <b><hr class = "my-4" style="width: 75%; "></b>
    
    </div>

    {% if datos.proyectos %}

    <div style="text-align: center; width: 350px; height: 210px; display: inline-block; margin: 20px; vertical-align: top; border: 2px solid rgb(11, 32, 68); border-radius: 5%;">

        <div style="margin: 15px;">

            <form method="POST">

                {% csrf_token %}
     
                <div>
     
                <h6 style= "font-family: Arial, Helvetica, sans-serif; color: rgb(11, 32, 68); ">Estudio de un proyecto</h6>
                
               </div>
     
                <select name="proyecto" class="custom-select" style="width: 200px; margin-top: 10px;">
     
                    {% if request.user.username != "HC" %}
     
                    {% for i in datos.proyectos %}
     
                    {% if not "DIANCO" in i.nombre %}
     
                    <option value="{{i.0}}">{{i.1}}</option>
     
     
                    {% endif %}
     
                    {% endfor %}
     
                    {% else %}
     
                    {% for i in datos.proyectos %}
     
                    {% if "DIANCO" in i.nombre %}
                    <option value="{{i.id}}">{{i.nombre}}</option>
     
                    {% endif %}
     
                    {% endfor %}
     
                    
                    {% endif %}
     
     
                  </select>
                  
                  
     
                  <div>
                    <button class="btn btn-dark" type="submit" style="margin-top: 10px;"><img src="{% static 'img/buscar2.png' %}" alt="" style="max-width:20px; height:auto;"> Buscar</button>          
                </div>
                
            </form>
     
            <b><hr class = "my-4" style="width: 75%; "></b>


        </div>
       

   </div>

   <div style="text-align: center; width: 350px; height: 210px; display: inline-block; margin: 20px; vertical-align: top; border: 2px solid rgb(11, 32, 68); border-radius: 5%;">

    <div style="margin: 15px;">

        <div>
     
            <h6 style= "font-family: Arial, Helvetica, sans-serif; color: rgb(11, 32, 68);">Analisis conjunto</h6>


            
           </div>

           

           <div>

            <img src="{% static 'img/grupo.png' %}" alt="" style="max-width:40px; height:auto;">
           </div>


    </div>

    <div style="margin: 15px; ">

        <a href="{% url 'Consolidado' %}"><button class="btn btn-dark"><img src="{% static 'img/reportar.png' %}" alt="" style="max-width:20px; height:auto;"> Reporte </button></a>

    </div>

        
    <b><hr class = "my-4" style="width: 75%; "></b>

   </div>

   

   {% endif %}

   {% if datos.mensaje == 1 %}

   <div  style="margin-top: -15%;">
    <h6> Este proyecto no tiene todos los requerimientos cargados </h6>
    <small> Contactar con AR/VI</small>
</div>

<div style="text-align: center; margin-top: 2%; margin-bottom: 10%;">
    
    <img src="{% static 'img/comunicaciones.png' %}" style="max-width:10%;width:auto;height:auto; margin-top: 1rem;">

</div>

   {% endif %}



   {% if datos.proyectos == 0 %}

    <div style="margin-bottom: 2rem;">

    <img src="{{datos.datos.0.iamgen.url}}"  class="img-fluid" alt="..." style="max-width:250px; height:auto; margin-bottom: 2rem;">


    <h3 style="color: rgb({{datos.datos.0.color}});">Evaluación de {{datos.datos.0.nombre}}</h3>

    
    </div>

    

    <div style="background-color: rgba({{datos.datos.0.color}}, 0.2) ;">

        <hr class = "my-4" style="width: 100%; border-color: rgba({{datos.datos.0.color}}, 0.5);">

        <h5> Resumen de los datos </h5>

        <hr class = "my-4" style="width: 100%; border-color: rgba({{datos.datos.0.color}}, 0.5);">


    </div>

    

    

    

    <div  style="text-align: left;">

    <h6>Saldo de caja a la fecha: <small>$ {{datos.datos.3.5|floatformat:0|intcomma}}</small>  </h6>
    <h6>Costos del proyecto: <small>$ {{datos.datos.3.2|floatformat:0|intcomma}}</small>  </h6>
    <h6>Ingresos del proyecto: <small>$ {{datos.datos.3.3|floatformat:0|intcomma}}</small>  </h6>
    <h6>Saldo del proyecto: <small>$ {{datos.datos.3.6|floatformat:0|intcomma}}</small>  </h6>
    <h6>Rentabilidad: <small>{{datos.datos.3.4|floatformat:0|intcomma}}%</small>  </h6>
    <p><small style="color: #5DB150;">Valor del USD BLUE: $ {{datos.usd.valor}}</small></p>

    <!--
    <div style="text-align: left;">

        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter" style="background-color: rgba({{datos.datos.0.color}}, 0.8); border-color: rgba({{datos.datos.0.color}}, 1)">
          Ver historico
        </button>


      </div>

    -->


    <!-- Modal -->
    <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLongTitle">Ingrese una fecha del listado</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">

                <form action="" method="GET">

                    {% csrf_token %}
        
                    <select name="{{datos.datos.0.id}}" class="custom-select" style="width: 200px; margin-top: 10px;">

                        {% for i in datos.lista %}
                    
                    
                        <option value="{{i.fecha|date:'Ymd'}}">{{i.fecha}}</option>

                        {% endfor %}
                    
                    
                    </select>

                    <div>
                        <button class="btn btn-dark" type="submit" style="margin-top: 10px;">Buscar datos</button>
        
                    </div>

                    
                </form>
              </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
       
            </div>
          </div>
        </div>
      </div>

    </div>

    

    <div style="background-color: rgba({{datos.datos.0.color}}, 0.2) ;">

        <hr class = "my-4" style="width: 100%; border-color: rgba({{datos.datos.0.color}}, 0.5);">

        <h5> Desglose completo </h5>

        <hr class = "my-4" style="width: 100%; border-color: rgba({{datos.datos.0.color}}, 0.5);">


    </div>


    <div style="display: inline-block; width: 350px; margin: 20px;">

        <h5>Ingresos del proyecto</h5>
        <hr class = "my-4" style="width: 70%; border-color: rgba({{datos.datos.0.color}}, 0.3);">


        <div style="display: inline-block; width: 170px; vertical-align: top; text-align: left;">
             

            <h6>Prestamos a cobrar:</h6>
            <h6><small>Prestamos a proyectos:</small></h6>
            <h6><small>Prestamos a otros:</small></h6>
            <h6>Cuotas cobradas:</h6>
            <h6>Cuotas a cobrar:</h6>
            <h6>Ingreso por ventas:</h6>
            <h6> <small>(Unidades de Socios):</small> </h6>
            
    
            
        </div>

        <div style="display: inline-block; width: 170px; vertical-align: top; text-align: right;">
             

            <h6>$ {{datos.datos.3.1|floatformat:0|intcomma}}   </h6>
            <h6><small>$ {{datos.datos.2.prestamos_proyecto|floatformat:0|intcomma}}  </small></h6>
            <h6><small>$ {{datos.datos.2.prestamos_otros|floatformat:0|intcomma}}</small></h6>
            <h6>$ {{datos.datos.2.cuotas_cobradas|floatformat:0|intcomma}}  </h6>
            <h6>$ {{datos.datos.2.cuotas_a_cobrar|floatformat:0|intcomma}}  </h6>
            <h6>$ {{datos.datos.2.ingreso_ventas|floatformat:0|intcomma}}  </h6>
            <h6> <small> $ {{datos.datos.2.unidades_socios|floatformat:0|intcomma}}  </small></h6>
            
            
        </div>

        <div style="vertical-align: top; margin-top: 2%;">
            <h6 style="color: #3FB360;">Ingresos totales: ${{datos.datos.3.3|floatformat:0|intcomma}}</h6>
    
        </div >


    </div>

    <div style="display: inline-block; width: 350px; vertical-align: top; margin: 20px;">

        <h5>Costos del proyecto</h5>
        <hr class = "my-4" style="width: 70%; border-color: rgba({{datos.datos.0.color}}, 0.3);">

        <div style="display: inline-block; width: 170px; vertical-align: top; text-align: left;">

        <h6>Gastado a la fecha:</h6>
        <h6>Cheques emitidos:</h6>
               
        <h6>Pendiente de gastar: </h6>
        <h6><small>Administración:</small></h6>
        <h6><small>Comisión:</small></h6>
        <h6><small>Materiales:</small></h6>
        <h6><small>MO y subcontratos:</small></h6>
        <h6><small>Imprevistos:</small></h6>
        <h6><small>Creditos de materiales:</small></h6>
        <h6><small>Fondos de reparo:</small></h6>
        <h6><small>Adelantos: </small></h6>
        <h6><small>I.V.A sobre compras: </small></h6>
        <h6><small>II.BB + T.E.M:</small></h6>
        <h6>Prestamos:</h6>
        
        </div>

        <div style="display: inline-block; width: 170px; vertical-align: top; text-align: right;">

            <h6>$ {{datos.datos.2.gastos_fecha|floatformat:0|intcomma}} </h6>
        <h6>$ {{datos.datos.2.cheques_emitidos|floatformat:0|intcomma}} </h6>
               
        <h6>$ {{datos.datos.3.0|floatformat:0|intcomma}}   </h6>
        <h6><small>$ {{datos.datos.2.pendiente_admin|floatformat:0|intcomma}}   </small></h6>
        <h6><small>$ {{datos.datos.2.pendiente_comision|floatformat:0|intcomma}}   </small></h6>
        <h6><small>$ {{datos.datos.1.saldo_mat|floatformat:0|intcomma}}  </small></h6>
        <h6><small>$ {{datos.datos.1.saldo_mo|floatformat:0|intcomma}}  </small></h6>
        <h6><small>$ {{datos.datos.1.imprevisto|floatformat:0|intcomma}}  </small></h6>
        <h6><small>$ {{datos.datos.1.credito|floatformat:0|intcomma}}  </small></h6>
        <h6><small>${{datos.datos.1.fdr|floatformat:0|intcomma}}</small></h6>
        <h6><small>$ - {{datos.datos.2.pendiente_adelantos|floatformat:0|intcomma}}   </small></h6>
        <h6><small>$ {{datos.datos.2.pendiente_iva_ventas|floatformat:0|intcomma}}   </small></h6>
        <h6><small>$ {{datos.datos.2.pendiente_iibb_tem|floatformat:0|intcomma}}</small></h6>
        <h6>$ {{datos.datos.2.Prestamos_dados|floatformat:0|intcomma}}  </h6>
        
        </div>

        

        


        <div style="vertical-align: top; margin-top: 2%;">
            <h6 style="color: #B3513F ; vertical-align: bottom;" >Total del costo: ${{datos.datos.3.2|floatformat:0|intcomma}}</h6>
    
        </div>

    </div>




    


    

    <div style="margin-top: 5%; margin-bottom: 5%;">
        <h6 style="color: rgb({{datos.datos.0.color}})">BENEFICIO: $ {{datos.datos.3.6|floatformat:0|intcomma}}</h6>
        <h5 style="margin-top: 1%; color: rgb({{datos.datos.0.color}})">RENDIMIENTO: {{datos.datos.3.4|floatformat:0|intcomma}}%</h5>
    </div>

    <div style="background-color: rgba({{datos.datos.0.color}}, 0.2);">

        <hr class = "my-4" style="width: 100%; border-color: rgba({{datos.datos.0.color}}, 0.5);">

        <h5> Escenario despues de descuentos y retiros </h5>

        <hr class = "my-4" style="width: 100%; border-color: rgba({{datos.datos.0.color}}, 0.5);">


    </div>

    <div style="text-align: left;">
        <h6>Descuento de sobre unidades en venta/socios (6%): - $ {{datos.datos.3.7|floatformat:0|intcomma}} </h6>
        <h6>Retiros de socios: - $ {{datos.datos.3.10|floatformat:0|intcomma}} </h6>
    </div>


    <div style="margin-top: 5%; margin-bottom: 5%;">
        <h6 style="color: rgb({{datos.datos.0.color}})">BENEFICIO DESPUES DE DESCUENTO: $ {{datos.datos.3.8|floatformat:0|intcomma}}</h6>
        <h5 style="margin-top: 1%; color: rgb({{datos.datos.0.color}})">RENDIMIENTO: {{datos.datos.3.9|floatformat:0|intcomma}}%</h5>
    </div>

    <hr class = "my-4" style="width: 50%; border-color: rgba({{datos.datos.0.color}}, 0.5);">

   

    
    {% endif %}

    
    


    <div style="text-align: center; margin-top: 10%;">
        <p style="font-family: Arial, Helvetica, sans-serif;"> <small>-- Link<strong>P</strong> --</small> </p>

     </div>


</div>
{% endblock %}