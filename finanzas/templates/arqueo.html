{% extends "users/inicio2.html" %}

{% load static %}
{% load humanize %}

{% block content %}

<div class="container-fluid r-aside">
    <!-- ============================================================== -->
    <!-- Bread crumb and right sidebar toggle -->
    <!-- ============================================================== -->
    <div class="row page-titles">
        <div class="col-md-5 align-self-center">
            <h3 class="text-themecolor">Arqueo diario</h3>
        </div>

        <div class="col-md-7 align-self-center">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'Inicio' %}">Inicio</a></li>
                <li class="breadcrumb-item"><a href="{% url 'Arqueos diario' %}">Arqueos</a></li>
                <li class="breadcrumb-item">{{ data_cruda.fecha|date:"d-m-Y" }}</li>
            </ol>
        </div>

    </div>

  </div>

  <div class="row">
    <div class="col-lg-6 col-md-12">
        <div class="card">
            <div class="card-body">
                <div class="d-flex">
                    <div>
                        <h4 class="card-title"><span class="lstick"></span>Resumen de datos</h4></div>

                </div>

                <div class="m-t-10">
                    <h5 class="m-b-0 font-medium">Fecha del arqueo: {{ data_cruda.fecha|date:"d-m-Y" }}</h5>
                    <h6 class="text-muted">De esta fecha se alimenta los datos</h6>
                </div>
                <div class="m-t-10">
                    <h5 class="m-b-0 font-medium">Efectivo: $ {{otros_datos.2|floatformat:0|intcomma}}</h5>
                    <h6 class="text-muted">Liquidez en pesos</h6>
                </div>
                <div class="m-t-10">
                    <h5 class="m-b-0 font-medium">Bancos: $ {{otros_datos.4|floatformat:0|intcomma}}</h5>
                    <h6 class="text-muted">Suma de todos los bancos</h6>
                </div>
                <div class="m-t-10">
                    <h5 class="m-b-0 font-medium">Cheques: $ {{otros_datos.3|floatformat:0|intcomma}}</h5>
                    <h6 class="text-muted">Suma de valores cheques a cobrar</h6>
                </div>
                <div class="m-t-10">
                    <h5 class="m-b-0 font-medium">Dolares: U$D {{otros_datos.0|floatformat:0|intcomma}}</h5>
                    <h6 class="text-muted">Liquidez en dolares, tipo de cambio ${{ cambio_usd|floatformat:0|intcomma }}</h6>
                </div>
                <div class="m-t-10">
                    <h5 class="m-b-0 font-medium">Euros: € {{otros_datos.1|floatformat:0|intcomma}}</h5>
                    <h6 class="text-muted">Liquidez en Euros, tipo de cambio ${{ cambio_euro|floatformat:0|intcomma }}</h6>
                </div>
                <div class="m-t-10">
                    <h5 class="m-b-0 font-medium">Total historico: $ {{otros_datos.5|floatformat:0|intcomma}}</h5>
                    <h6 class="text-muted">Canja consolidada en pesos historica</h6>

                    <!-- Este es el total de la caja {{otros_datos.5|floatformat:0|intcomma}}-->
                </div>
                <div class="m-t-10">
                    <h5 class="m-b-0 font-medium">Total: $ {{otros_datos.6|floatformat:0|intcomma}}</h5>
                    <h6 class="text-muted">Canja consolidada en pesos a valores de hoy</h6>

                    <!-- Este es el total de la caja {{otros_datos.5|floatformat:0|intcomma}}-->
                </div>
                

                

            </div>
        </div>
    </div>

    <div class="col-lg-6 col-md-12">
        <div class="card">
            <div class="card-body">
                <div class="d-flex">
                    <div>
                        <h4 class="card-title"><span class="lstick"></span>Proporción</h4></div>

                </div>

                <div style="display: inline-block; width: 310px; margin: 10px;">

                    <canvas id="myChart2"></canvas>
                
                </div>

                <table class="table vm font-14">
                    <tr>
                        <td class="b-0">Moneda extranjera</td>
                        <td class="text-right font-medium b-0"><script>document.write(Math.round(Math.round({{otros_datos.7|floatformat:0}})/Math.round({{otros_datos.6|floatformat:0}})*100))</script>%</td>
                    </tr>
                    <tr>
                        <td>Efectivo</td>
                        <td class="text-right font-medium"><script>document.write(Math.round(Math.round({{grafico.0.2|floatformat:0}})/Math.round({{otros_datos.6|floatformat:0}})*100))</script>%</td>
                    </tr>
                    <tr>
                        <td>Banco</td>
                        <td class="text-right font-medium"><script>document.write(Math.round(Math.round({{grafico.0.3|floatformat:0}})/Math.round({{otros_datos.6|floatformat:0}})*100))</script>%</td>
                    </tr>
                    <tr>
                        <td>Cheque</td>
                        <td class="text-right font-medium"><script>document.write(Math.round(Math.round({{grafico.0.4|floatformat:0}})/Math.round({{otros_datos.6|floatformat:0}})*100))</script>%</td>
                    </tr>
                </table>

                

            </div>
        </div>
    </div>


    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Detalle por proyecto</h4>
                <h6 class="card-subtitle">Resumen de datos</h6>
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Proyecto</th>
                                <th>Efectivo</th>
                                <th>Banco</th>
                                <th>Cheques</th>
                                <th>Moneda Ext.</th>
                                <th>Caja Historica</th>
                                <th>Dolares</th>
                                <th>Euros</th>
      
                            </tr>
                        </thead>

                        <tbody>

                            {% for i in datos %}  
                
                            <tr>
            
                                <td>
                                    
                                    <div>
                                        {% if i.0 %}
        
                                        <span class="label label-success">{{ i.1 }}</span>
                                        {% else %}
            
                                        <span class="label label-info">{{ i.1 }}</span>
                                        
                    
                                        {% endif %}
                                    </div></td>
                                
                                <td>${{ i.2|floatformat:0|intcomma }}</td>
                                <td>${{ i.7|floatformat:0|intcomma }}</td>
                                <td>${{ i.5|floatformat:0|intcomma }}</td>
                                <td>${{ i.6|floatformat:0|intcomma }}</td>
                                <td>${{ i.8|floatformat:0|intcomma }}</td>
                                <td style="color: rgb(89, 171, 70);">U$S {{ i.3|floatformat:0|intcomma }}</td>
                                <td style="color: rgb(76, 88, 173)">€ {{ i.4|floatformat:0|intcomma }}</td>
                               
            
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

   


   <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
   
       <script>
            
            var ctx = document.getElementById('myChart2').getContext('2d');
            var chart = new Chart(ctx, {
                // The type of chart we want to create
                type: 'doughnut',
                // The data for our dataset
                data: {
                datasets: [{        
                    data: [Math.round({{otros_datos.7|floatformat:0}})/1000000, Math.round({{grafico.0.2|floatformat:0}})/1000000, Math.round({{grafico.0.3|floatformat:0}})/1000000, Math.round({{grafico.0.4|floatformat:0}})/1000000],
                    backgroundColor: ['rgb(56, 229, 98 , 0.5)', 'rgb(25, 71, 175 , 0.5)', 'rgb(222, 65, 37  , 0.5)', 'rgb(231, 206, 27  , 0.5)'],    
                }],
      
                labels: ['Moneda extranjera', 'Efectivo', 'Banco', 'Cheque' ]
              },
                options: {
                  legend: {
                      position: 'right'
                  },
                },
      
              });
      
        </script>
        <script>
       var ctx = document.getElementById('myChart').getContext('2d');
       var chart = new Chart(ctx, {
           // The type of chart we want to create
           type: 'bar',

           // The data for our dataset
           data: {

               labels: [
                   {% for i in grafico %}
                   '{{i.0}}',                   
                   {% endfor %}
  
                   ],
               datasets: [{
                   label: 'Moneda extranjera',
                   backgroundColor: 'rgb(56, 229, 98 , 0.5)',
                   borderColor: 'rgb(56, 229, 98)',
                   borderWidth: 1,
                   data: [
                   {% for i in grafico  %}
                   Math.round({{i.1|floatformat:0}})/1000000,  
                                    
                   {% endfor %}

                   ]
               },
               {
                   label: 'Efectivo',
                   backgroundColor: 'rgb(25, 71, 175 , 0.5)',
                   borderColor: 'rgb(25, 71, 175)',
                   borderWidth: 1,
                   data: [
                   {% for i in grafico  %}
                   Math.round({{i.2|floatformat:0}})/1000000,  
                                    
                   {% endfor %}

                   ]
               },
               {
                   label: 'Banco',
                   backgroundColor: 'rgb(222, 65, 37  , 0.5)',
                   borderColor: 'rgb(222, 65, 37 )',
                   borderWidth: 1,
                   data: [
                   {% for i in grafico  %}
                   Math.round({{i.3|floatformat:0}})/1000000,  
                                    
                   {% endfor %}

                   ]
               },
               {
                   label: 'Cheque',
                   backgroundColor: 'rgb(231, 206, 27  , 0.5)',
                   borderColor: 'rgb(231, 206, 27)',
                   borderWidth: 1,
                   data: [
                   {% for i in grafico  %}
                   Math.round({{i.4|floatformat:0}})/1000000,  
                                    
                   {% endfor %}

                   ]
               },],

           },

           // Configuration options go here
           options: {

               scales: {

                   xAxes: [
                       {

                           stacked: true,
                           display: false,
                           barThickness: 40,

                       }
                   ],
                   yAxes: [
                       {
                            stacked: true,
                           ticks: {
                                beginAtZero: true,
                               min: 0,
                               stepSize: 10,
                               callback: function(label, index, labels) {
                                   return '$ '+ label + 'Millones';
                                   
                               }
                           },
                           scaleLabel: {
                               display: true,
                    
                           },

                       }
                   ],
               },
           }

       });
       

       
   </script>


{% endblock %}
