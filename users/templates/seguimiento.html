{% extends "users/inicio2.html" %}

{% load static %}
{% load humanize %}

{% block content %}

<div class="container-fluid r-aside">
    <!-- ============================================================== -->
    <!-- Cabeza de la pagina -->
    <!-- ============================================================== -->
    <div class="row page-titles">
        <div class="col-md-5 align-self-center">
            <h3 class="text-themecolor">Tablero R.E.G.A</h3>
        </div>

        <div class="col-md-7 align-self-center">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'Inicio' %}">Inicio</a></li>
                <li class="breadcrumb-item">Tablero</li>

            </ol>
        </div>

    </div>

  </div>


  <div class="row">

    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Filtros del tablero</h4>
                <h6 class="card-subtitle">Selecciona las condiciones de los datos</h6>
                <div class="dropdown">
                    <button class="dropbtn btn btn-primary" style="background-color: rgb({{proyecto.color}}); border-color: rgb({{proyecto.color}})">{% if proyecto %} {{proyecto.nombre}} {% else %}Proyecto{% endif %}</button>
                    <div class="dropdown-content">
                        <a href="{% url 'Tablero Rega' 0 id_area id_estado %}">Todos</a>
                        {% for p in list_project %}
                        <a href="{% url 'Tablero Rega' p.id id_area id_estado %}">{{p.nombre}}</a>
                        {% endfor %}


                    </div>
                </div>
                <div class="dropdown">
                    <button class="dropbtn btn btn-primary" style="background-color: rgb({{area.1}}); border-color: rgb({{area.1}})">{{area.0}}</button>
                    <div class="dropdown-content">
                    <a href="{% url 'Tablero Rega' id_proyecto 0 id_estado %}">Todas</a>
                    <a href="{% url 'Tablero Rega' id_proyecto 1 id_estado %}">Administración</a>
                    <a href="{% url 'Tablero Rega' id_proyecto 2 id_estado %}">Compras</a>
                    <a href="{% url 'Tablero Rega' id_proyecto 3 id_estado %}">Comercialización</a>
                    <a href="{% url 'Tablero Rega' id_proyecto 4 id_estado %}">Dirección</a>
                    <a href="{% url 'Tablero Rega' id_proyecto 5 id_estado %}">Presupuestos</a>
                    <a href="{% url 'Tablero Rega' id_proyecto 6 id_estado %}">Obra</a>
                    <a href="{% url 'Tablero Rega' id_proyecto 7 id_estado %}">Tecnica</a>
                    <a href="{% url 'Tablero Rega' id_proyecto 8 id_estado %}">Recursos Humanos</a>

                    </div>
                </div>
                <div class="dropdown">
                    <button class="dropbtn btn btn-primary">{{estado}}</button>
                    <div class="dropdown-content">
                    <a href="{% url 'Tablero Rega' id_proyecto id_area 0 %}">Todos</a>
                    <a href="{% url 'Tablero Rega' id_proyecto id_area 1 %}">Activos</a>                    
                    <a href="{% url 'Tablero Rega' id_proyecto id_area 2 %}">Trabajando</a>
                    <a href="{% url 'Tablero Rega' id_proyecto id_area 3 %}">Problemas</a>
                    <a href="{% url 'Tablero Rega' id_proyecto id_area 4 %}">Listo</a>
                    <a href="{% url 'Tablero Rega' id_proyecto id_area 5 %}">Espera</a>
                    
                </div>
                </div>
            </div>
        </div>
    </div>
</div>

  <div class="row">

    {% for d in data %}

    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">ÁREA {{d.0.0}}</h4>
                {% if d.1 %}               
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                {% if proyecto == 0 %}
                                <th>Proyecto</th>
                                {% endif %}
                                <th>Tarea</th>
                                <th>Inicio</th>
                                <th>Final</th>
                                <th>Responsable</th>
                                <th>Adjunto</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for i in d.1 %}
                            <tr>
                                {% if proyecto == 0 %}
                                <td style="color: rgb({{i.proyecto.color}});">{{i.proyecto.nombre}}</td>
                                {% endif %}
                                <td><div>{{i.nombre}}</div>
                                    {% if i.estado == "LISTO" %} 
                                    <div class="label label-table label-success">Listo</div>
                                    {% elif i.estado == "TRABAJANDO" %} 
                                    <div class="label label-table label-warning">Trabajando</div>
                                    {% elif i.estado == "PROBLEMAS" %}
                                    <div class="label label-table label-danger">Problemas</div>
                                    {% else %}
                                    <div class="label label-table label-info">Espera</div>
                                    {% endif %} 
                                </td>
                                <td>{% if i.fecha_inicio %}<span class="text-muted"><i class="fa fa-clock-o"></i> {{i.fecha_inicio|date:"d-m-Y"}}</span>{% else %} Sin asignar {% endif%} </td>
                                <td>{% if i.fecha_final %}<span class="text-muted"><i class="fa fa-clock-o"></i> {{i.fecha_final|date:"d-m-Y"}}</span>{% else %} Sin asignar {% endif%} </td>
                                <td {% if i.responsable %} style="text-align: center;"{% endif %}>{% if i.responsable %}<img src="{{i.responsable.imagenlogo.url}}" alt="user" width="50">{% else %} Sin asignar {% endif %}</td>
                                <td>Adj.</td>
                            </tr>

                            {% endfor %}
                            
                        </tbody>
                    </table>
                </div>
                {% else %}
                <h6 class="card-subtitle">No tiene tareas que cumplan con estas condiciones</h6>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="row">

        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title">Usuarios del tablero</h4>
                    <h6 class="card-subtitle">Solo los usuarios presentados tienen acceso a este lugar</h6>
                    {% for u in list_users %}
                    <span class="image-list m-t-10">
                        <a href="#"><img src="{{u.imagenlogo.url}}" class="img-circle" alt="user" width="40" /></a>

                    </span>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    {% endfor %}


  </div>


  {% endblock %}