{% extends "users/inicio.html" %}

{% load static %}
{% load humanize %}

{% block content %}

<div class = "jumbotron" style="background-color: white; margin-bottom: 0px; text-align: center;">

    <h3 style="font-family: Arial, Helvetica, sans-serif;">Correspondencia</h3>

    <small style="font-family: Arial, Helvetica, sans-serif;"><b>Modulo:</b> Comunicación </small>

     <b><hr class = "my-4" style="width: 100%;"></b>

     <form method="POST" style="text-align: left;">

        {% csrf_token %}

        <div style="display: inline-block; margin-left: 1rem;">

            <label for="palabra"><h6 style="font-family: Arial, Helvetica, sans-serif;">Buscar</h6></label>

        </div>
        
        <div style="display: inline-block; margin-left: 1rem; ">

            <input name="palabra" type="text" class="form-control form-control" placeholder="Buscar por palabra" list="art" style="width: 250px;">

        </div>
       
      

     </form>

    <b><hr class = "my-4" style="width: 100%;"></b>

    {% if request.user.username != "HC" %}

    <div style="text-align: left;">

        <div class="btn-group" role="group" aria-label="Button group with nested dropdown">
            <button type="button" class="btn btn-primary">Proyecto</button>
            <div class="btn-group" role="group">
                <button id="btnGroupDrop1" type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
                <div class="dropdown-menu" aria-labelledby="btnGroupDrop1" style="">


                    <div style="margin: 2px;">
    
                        <a href="{% url 'Notas de pedido' '0' tipo %}" style="margin-top: 5px; color:  rgb({{i.color}})" >TODOS</a>
    
                    </div>

                    {% for i in lista_proyectos %}
    
                    <div style="margin: 2px;">
    
                        <a href="{% url 'Notas de pedido' i.id tipo %}" style="margin-top: 5px; color:  rgb({{i.color}})" >{{i.nombre}}</a>
    
                    </div>

                    {% endfor %}

        
                    
                </div>
            </div>
            </div>

        <div class="btn-group" role="group" aria-label="Button group with nested dropdown">
            <button type="button" class="btn btn-primary">Tipo</button>
            <div class="btn-group" role="group">
                <button id="btnGroupDrop1" type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
                <div class="dropdown-menu" aria-labelledby="btnGroupDrop1" style="">

                    <div style="margin: 2px;">
    
                        <a href="{% url 'Notas de pedido' id_proyecto '0' %}" style="margin-top: 5px;)" >TODO</a>
    
                    </div>

    
                    <div style="margin: 2px;">
    
                        <a href="{% url 'Notas de pedido' id_proyecto '1' %}" style="margin-top: 5px;)" >NOTAS DE PEDIDO</a>
    
                    </div>


                    <div style="margin: 2px;">
    
                        <a href="{% url 'Notas de pedido' id_proyecto '2' %}" style="margin-top: 5px;)" >ORDENES DE SERVICIO</a>
    
                    </div>

        
                    
                </div>
            </div>
            </div>
    
    
        <div style="text-align: left; display: inline-block;">

    
            <a href= "#" class="btn btn-outline-info" style="text-align: end; margin-top: 5px;" > <b>+</b> Nueva correspondencia</a>
    
        
            </div>
    
    </div>

    {% endif %}


    
    
    
    

    <div class = "tableconteinerabel">
        <table class = "table table-hover" style="text-align: center; margin-top: 5px;" >
            <thead>
    
                <tr class = "table-dark">
                    <th scope = "row" style="vertical-align: middle;"> <small> <strong>TIPO</strong> </small> </th>
                    <th scope = "row" style="vertical-align: middle;"> <small> <strong>Nº</strong> </small> </th>
                    <th scope = "row" style="vertical-align: middle;"> <small> <strong>PROYECTO</strong> </small> </th>
                    <th scope = "row" style="vertical-align: middle;"> <small> <strong>CREADOR</strong> </small> </th>
                    <th scope = "row" style="vertical-align: middle;"><small> <strong>DESTINATARIO</strong> </small> </th>
                    <th scope = "row" style="vertical-align: middle;"><small> <strong>TITULO</strong> </small> </th>                    
                    <th scope = "row" style="vertical-align: middle;" class="priority-5"> <small> <strong>FECHA DE CREACIÓN</strong> </small></th>
                    <th scope = "row" style="vertical-align: middle;"> <small> <strong>ADJUNTOS</strong> </small></th>
                    <th scope = "row" style="vertical-align: middle;"> <small> <strong>FIRMA</strong> </small></th>
                    
                </tr>
            </thead>
    
            <tbody>

                
               
                {% for i in datos %}

                <tr class = "table-light">
                    <td style="width: 5%;"> <small> <strong>{{i.tipo}}</strong></small></td> 
                    <td style="width: 5%;"> <small> <strong>{{i.numero}}</strong></small></td> 
                    <td style="width: 10%;"> <small> <strong>{{i.proyecto}}</strong></small></td>              
                    <td style="width: 8%;"> <small>{{i.creador}}</small></td>
                    <td style="width: 8%;" > <small>{{i.destinatario}}</small></td>
                    <td style="width: 20%;"><small> <a href=" {% url 'Nota de pedido' i.id %}"><b>{{i.titulo}}</b></a>  </small> </td>
                    <td style="width: 20%;" class="priority-5"> <small>{{i.fecha_creacion}}</small></td>

                    {% if i.adjuntos %}

                    <td style="width: 5%;"> <small><a href="{{i.adjuntos.url}}"><img src="{% static 'img/archivo-adjunto.png' %}" alt="" style="max-width:25px; height: auto; margin: 5px;"   ></a></small></td>

                    {% else %}

                    <td style="width: 5%;"> <small>NO</small></td>

                    {% endif %}

                    {% if user.username in i.copia %}

                        {% if user.username in i.visto %}

                        <td style="width: 10%;  color: rgb(59, 186, 39);"> <small> <b>Ya firmaste!</b> </small></td>

                        {% else %}

                        <td style="width: 10%; color: rgb(186, 55, 39);"> <small><b>Pendiente de firmar!</b></small></td>

                        {% endif %}

                    {% else %}

                    <td style="width: 10%;"> <small><b>No firmas</b></small></td>

                    {% endif %}



                </tr>

                    {% endfor %}

            </table>
    </div>

    <b><hr class = "my-4" style="width: 100%;"></b>


        <div>
            <small style="font-family: Arial, Helvetica, sans-serif;">El listado puede continuar, se limita el numero de filas visibles</small>
        </div>


    <div style="margin-top: 2rem;">

        <p style="font-family: Arial, Helvetica, sans-serif;"> <small>-- Link<strong>P</strong> --</small> </p>

     </div>
        
    

                    
</div>
 
    
{% endblock %}