{% extends "users/inicio2.html" %}

{% load static %}
{% load humanize %}

{% block content %}

<div class="container-fluid r-aside">

  <div class="row page-titles">
    <div class="col-md-5 align-self-center">
      <h3 class="text-themecolor">Incremento indice de hormigón</h3>
    </div>

    <div class="col-md-7 align-self-center">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'Inicio' %}">Inicio</a></li>
        <li class="breadcrumb-item">Incremento hormigón</li>
      </ol>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-body row">
        <div class="col-12 justify-content-center">

          <div class="text-center my-3">
            <h3>Incremento indice de hormigón</h3>
          </div>

          <!-- Modal -->
          <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
            aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLongTitle">Sube el archivo!</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">

                  <form role="form" enctype="multipart/form-data" action="" method="POST" id="upload-image-form">

                    {% csrf_token %}

                    <div style="display: inline-block; margin: 10px; ">

                      <input type="file" class="form-control-file" name="adjunto" aria-describedby="fileHelp">

                    </div>

                    <div style="margin: 10px; ">

                      <small>*El archivo se subira con la fecha de hoy</small>

                    </div>

                    <button type="submit" class="btn btn-primary">Subir</button>

                  </form>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>

                </div>
              </div>
            </div>
          </div>

          <div style="text-align: left;">

            <form method="POST" style="display: inline-block">

              {% csrf_token %}

              <div style="display: inline-block; vertical-align: middle;">

                <h5>Archivos cargados: </h5>
              </div>

              <div style="display: inline-block;  vertical-align: middle;">

                <select name="fecha" class="custom-select" style="width: 200px;">

                  {% for i in datos %}

                  <option value="{{i.id}}">{{i.fecha|date:"Y-m-j"}}</option>

                  {% endfor %}

                </select>
              </div>

              <div style="display: inline-block;  vertical-align: middle;">
                <button class="btn" type="submit"><img src="{% static 'img/buscar2.png' %}" alt=""
                    style="max-width:20px; height:auto;"></button>
              </div>

            </form>

            <div style="display: inline-block;  vertical-align: middle;">

              <button type="button" class="btn " data-toggle="modal" data-target="#exampleModalCenter">
                <img src="{% static 'img/add.png' %}" alt="" style="max-width:20px; height:auto;">
              </button>

            </div>

            {% if busqueda %}

            <div style="display: inline-block;  vertical-align: middle;">
              <a class="btn btn-light" href="{{ busqueda.archivo.url }}" style="margin-top: 1%;">Ver informe <img
                  src="{% static 'img/reportar.png' %}" alt="" style="max-width:20px; height:auto;"></a>

            </div>

            {% endif %}

            <b>
              <hr class="my-4" style="width: 100%;">
            </b>

            <div class="row">
              <div class="col-12 d-flex justify-content-around text-center">

                <div class="col col-lg-4 card bg-dark border rounded mb-3">

                  <div class="card-body">

                    <h5 class=" text-white">Valor actual</h5>

                    <h4 style="color: rgb(52, 121, 214); font-family: Arial, Helvetica, sans-serif;">$ {{horm.valor}}/M3
                    </h4>

                  </div>
                </div>

                <div class="col col-lg-4 card bg-dark border rounded mb-3">

                  <div class="card-body ">

                    <h5 class=" text-white">Variación anual</h5>

                    <h4 style="color: rgb(48, 153, 29)">+ {{datos_h.0.12|floatformat:2}} %</h4>

                  </div>
                </div>
              </div>
            </div>

            <div>
              <small>*Sección CI (CI RUBROS DE OBRA) Código 544 – HORMIGONES – ELABORADO 0130 (Hormigón H21)</small>
            </div>

            <b>
              <hr class="my-4" style="width: 100%;">
            </b>

            <div class="table-responsive">

              <h5>Valores historicos</h5>

              <table id="example" class="table table-striped table-bordered" style="width:100%">
                <thead>

                  <tr>
                    <th></th>

                    {% for i in datos_h %}
                    <th colspan="2" style="text-align: center;"><b>{{i.0.0|date:"Y"}}</b></th>

                    {% endfor %}
                  </tr>
                </thead>

                <tbody>

                  <tr>

                    <td><small><b>ENERO</b></small></td>

                    {% for i in datos_h %}

                    <td><small>$ {{i.0.1|floatformat:0|intcomma}}</small></td>
                    <td><small>{{i.0.2|floatformat:2}} %</small> </td>

                    {% endfor %}

                  </tr>
                  <tr>

                    <td><small><b>FEBRERO</b></small></td>
                    {% for i in datos_h %}

                    <td><small>$ {{i.1.1|floatformat:0|intcomma}}</small></td>
                    <td><small>{{i.1.2|floatformat:2}} %</small> </td>

                    {% endfor %}

                  </tr>
                  <tr>

                    <td><small><b>MARZO</b></small></td>
                    {% for i in datos_h %}

                    <td><small>$ {{i.2.1|floatformat:0|intcomma}}</small></td>
                    <td><small>{{i.2.2|floatformat:2}} %</small> </td>

                    {% endfor %}

                  </tr>
                  <tr>

                    <td><small><b>ABRIL</b></small></td>
                    {% for i in datos_h %}

                    <td><small>$ {{i.3.1|floatformat:0|intcomma}}</small></td>
                    <td><small>{{i.3.2|floatformat:2}} %</small> </td>

                    {% endfor %}

                  </tr>
                  <tr>

                    <td><small><b>MAYO</b></small></td>
                    {% for i in datos_h %}

                    <td><small>$ {{i.4.1|floatformat:0|intcomma}}</small></td>
                    <td><small>{{i.4.2|floatformat:2}} %</small> </td>

                    {% endfor %}

                  </tr>
                  <tr>

                    <td><small><b>JUNIO</b></small></td>
                    {% for i in datos_h %}

                    <td><small>$ {{i.5.1|floatformat:0|intcomma}}</small></td>
                    <td><small>{{i.5.2|floatformat:2}} %</small> </td>

                    {% endfor %}

                  </tr>
                  <tr>

                    <td><small><b>JULIO</b></small></td>
                    {% for i in datos_h %}

                    <td><small>$ {{i.6.1|floatformat:0|intcomma}}</small></td>
                    <td><small>{{i.6.2|floatformat:2}} %</small> </td>

                    {% endfor %}

                  </tr>
                  <tr>

                    <td><small><b>AGOSTO</b></small></td>
                    {% for i in datos_h %}

                    <td><small>$ {{i.7.1|floatformat:0|intcomma}}</small></td>
                    <td><small>{{i.7.2|floatformat:2}} %</small> </td>

                    {% endfor %}

                  </tr>
                  <tr>

                    <td><small><b>SEPTIEMBRE</b></small></td>
                    {% for i in datos_h %}

                    <td><small>$ {{i.8.1|floatformat:0|intcomma}}</small></td>
                    <td><small>{{i.8.2|floatformat:2}} %</small> </td>

                    {% endfor %}

                  </tr>
                  <tr>

                    <td><small><b>OCTUBRE</b></small></td>
                    {% for i in datos_h %}

                    <td><small>$ {{i.9.1|floatformat:0|intcomma}}</small></td>
                    <td><small>{{i.9.2|floatformat:2}} %</small> </td>

                    {% endfor %}

                  </tr>
                  <tr>

                    <td><small><b>NOVIEMBRE</b></small></td>
                    {% for i in datos_h %}

                    <td><small>$ {{i.10.1|floatformat:0|intcomma}}</small></td>
                    <td><small>{{i.10.2|floatformat:2}} %</small> </td>

                    {% endfor %}

                  </tr>
                  <tr>

                    <td><small><b>DICIEMBRE</b></small></td>
                    {% for i in datos_h %}

                    <td><small>$ {{i.11.1|floatformat:0|intcomma}}</small></td>
                    <td><small>{{i.11.2|floatformat:2}} %</small> </td>

                    {% endfor %}

                  </tr>

                </tbody>

                <tbody class="table-light">

                  <tr>
                    <td><small><b>PROMEDIO ANUAL</b></small> </td>
                    {% for i in datos_h %}
                    <th scope="row" colspan="2"><b>{{i.12|floatformat:2}} %</b></th>

                    {% endfor %}

                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js" defer></script>
<script src="https://cdn.datatables.net/1.10.23/js/dataTables.bootstrap4.min.js" defer></script>


<script>
  $(document).ready(function () {
    $('#example').DataTable({
      "paging": false,
      "searching": false,
      "info": false
    });
  });
</script>


{% endblock %}