{% extends "users/inicio.html" %}

{% load static %}
{% load humanize %}

{% block content %}



<div class = "jumbotron" style="background-color: white; margin-bottom: 0px; text-align: center;" > 

    <div style="text-align: center;">
        <h2 style="font-family: Arial, Helvetica, sans-serif;">Historial de ventas</h2>

        {% if datos.fecha %}

        <h6>Fecha del informe: {{datos.fecha}}</h6>

        {% endif %}

        <small> <b>Modulo: </b> Comercializaci√≥n</small>


        <b><hr class = "my-4" style="width: 75%;"></b>
    
    </div>


          <form method="POST">

              {% csrf_token %}
   
              <div style="text-align: left;">

                <div style="display: inline-block; vertical-align: middle;">

                  <h6 style= "font-family: Arial, Helvetica, sans-serif;">Archivos cargados: </h6>
                        
          
                </div>

                <div style="display: inline-block;  vertical-align: middle;">


                  <select name="fecha" class="custom-select" style="width: 200px;">


                    {% for i in datos.fechas %}
      
                    <option value="{{i.1}}">{{i.0|date:"Y-m-j"}}</option>
      
                    {% endfor %}
      
      
      
                  </select>
                
                </div>
          
   
                <div style="display: inline-block;  vertical-align: middle;">
                  <button class="btn btn-light" type="submit"><img src="{% static 'img/buscar2.png' %}" alt="" style="max-width:20px; height:auto;"></button>          
              </div>
              
          </form>
   
          <b><hr class = "my-4" style="width: 75%; "></b>


          <div style="text-align: center;">

            <div class="card text-white bg-dark mb-3" style="display: inline-block; width: 310px; height: 150px; vertical-align: top; margin: 10px;">
                
              <div class="card-body">

                <h6>Unidades vendidas {{datos.datos_panel.2|date:"Y"}}</h6>

                <h4 style="color: rgb(48, 153, 29)">{{datos.datos_panel.0}}</h4>

                <div>
                  <small>Unidades vendidas {{datos.datos_panel.3|date:"Y"}}: <b>{{datos.datos_panel.1}}</b></small>
                </div>
                
              </div>
            </div>

            <div style="display: inline-block; width: 310px; margin: 10px;">
          
              <canvas id="myChart2"></canvas>
          
            </div>
             
            <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
            <script>
          
                var ctx = document.getElementById('myChart2').getContext('2d');
                var chart = new Chart(ctx, {
                    // The type of chart we want to create
                    type: 'doughnut',
                    // The data for our dataset
                    data: {
                    datasets: [{        
                        data: [{% for i in datos.datos_panel.4 %}
                      {{i.1}}, 
                      

                      {% endfor %}],
                        backgroundColor: [
                        {% for i in datos.datos_panel.4 %}
                      'rgba({{i.0.color}}, 0.7)', 
                      

                      {% endfor %}
                          ],    
                    }],
          
                    labels: [
                      {% for i in datos.datos_panel.4 %}
                      '{{i.0.nombre}}', 
                      

                      {% endfor %}

                      ]
                  },
                    options: {
                      legend: {
                          position: 'right'
                      },
                    },
          
                  });
          
            </script>
        
          </div>





      {% if datos.datos %}

       <div>
          <a href="{{ datos.datos.historial_venta.url }}" style="margin-top: 1%;"><img src="{% static 'img/reportar.png' %}" alt="" style="max-width:30px; height:auto;"> Informe encontrado!</a>

        </div>

        <small> Ingrese al link para ver el archivo</small>


        

      {% endif %}
       
       <div style="text-align: center; margin-top: 10%;">
        <p> <small>-- Link<strong>P</strong> --</small> </p>

     </div>
       
       
   </div>


{% endblock %}