{% extends "users/inicio.html" %}

{% load static %}
{% load humanize %}

{% block content %}

{% if perms.ventas.view_pricing %} 

<div class = "jumbotron" style="background-color: white; margin-bottom: 0px; text-align: center;">
    <div style="text-align: left; justify-content: left;">

        <div style="display: inline-block; vertical-align: middle; width: 250px; margin: 20px;">
            <img src="{{datos.proyecto.iamgen.url}}"  class="img-fluid" alt="..." style="width:auto;height:auto; ">


        </div>

        <div style="display: inline-block; vertical-align: middle; width: 350px;  margin: 20px;">
            <h4 style="color: rgb({{datos.proyecto.color}}); " >{{ datos.proyecto.nombre }} </h4>
            <h5 style="color: rgb({{datos.proyecto.color}}); " >Pricing de unidades </h5>


        </div>

        <div style="vertical-align: middle; margin: 20px; text-align: right;">

            <form method="POST" >

                {% csrf_token %}

                    <div style="display: inline-block;">

                        <input name="palabra" type="text" class="form-control form-control" placeholder="Buscar por palabra" list="art" width="300px">



                    </div>
        
        
                    
                    <img src="{% static 'img/buscar2.png' %}" alt="" style="max-width:25px; height:auto;"  >
        
             </form>

        </div>
    
    </div>


    <b><hr class = "my-4" style="width: 100%; border-color: rgba({{datos.proyecto.color}}, 0.5);"></b>



    {% if datos.datos_unidades %}

    
    <div class="card border-dark mb-3" style="display: inline-block; width: 300px; height: 180px; vertical-align: top; margin: 5px;">
        <div class="card-header">Precio base</div>  
        <div class="card-body">
            <h6> 

                {% if request.user.username == "IC" or request.user.username == "AR" %}

                <a type="button" data-toggle="modal" data-target="#exampleModalCenter">
                    <img src="{% static 'img/documento.png' %}" alt="" style="max-width:20px; height:auto;"  >
                </a>

                {% endif %}
                
                
                Actual: <small>${{datos.proyecto.desde|floatformat:0|intcomma}}</small></h6>

                
                <!-- Modal -->
                <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h5 class="modal-title" id="exampleModalLongTitle">Estas por modificar el precio del pricing!</h5>
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                          </button>
                        </div>
                        <div class="modal-body">
    
    
                          Cuando lo modifiques, espera unos segundos a que cargue todo!
                          
                          <form method="GET" style="margin: 15px;">
        
                            <div class="input-group mb-3">
                        
                                    <div class="input-group-prepend">
                        
                                        <span class="input-group-text">$</span>
                            
                                    </div>
                            
                                    <input name="precio_venta" type="number" class="form-control form-control" aria-label="Amount" style="width: 100px;">
                                 
                            </div>
                        
                        </form>
                        
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                   
                        </div>
                      </div>
                    </div>

                </div>

        <small>*Precio base que por una serie de parametros arma el precio de la unidad</small>
        </div>
      </div>


    <div class="card border-dark mb-3" style="display: inline-block; width: 300px; height: 180px; vertical-align: top; margin: 5px;">
        <div class="card-header">Promedio de reposición</div>  
        <div class="card-body">
            <h6>Prom. contado: <small>${{datos.otros_datos.0.4|floatformat:0|intcomma}}</small></h6>
            <h6>Prom. financiado: <small>${{datos.otros_datos.0.5|floatformat:0|intcomma}}</small></h6>
            <small>*unidades de proyecto usando sup. equivalente</small>
        </div>
      </div>

    <div class = "tableconteinerabel">

        <table class = "table table-hover" style="text-align: center;">
            <thead>
    
                <tr class = "table-dark">
                    <th scope = "row" style="vertical-align: middle;"> <small>PISO/NOM</small> </th>
                    <th scope = "row"style="vertical-align: middle;" colspan="2"> <small>TIPOLOGIA</small>  </th>
                    <th scope = "row"style="vertical-align: middle;"> <small>SUPERFICIE</small> </th>
                    <th scope = "row"style="vertical-align: middle;" class="priority-4"> <small>ASIGNACIÓN</small> </th>
                    <th scope = "row"style="vertical-align: middle;"> <small>ESTADO</small> </th>
                    <th scope = "row"style="vertical-align: middle;"> <small>CONTADO</small> </th>
                    <th scope = "row"style="vertical-align: middle;"> <small>CONT./M2</small> </th>
                    
                    <th scope = "row"style="vertical-align: middle;" class="priority-5"> <small>FINANCIADO</small> </th>
                    <th scope = "row"style="vertical-align: middle;" class="priority-5"> <small>FINAN./M2</small> </th>
                    <th scope = "row"style="vertical-align: middle;" class="priority-5"> <small>ANTICIPO ({{datos.anticipo}}%)</small> </th>
                    <th scope = "row"style="vertical-align: middle;" class="priority-5"> <small>CUOTAS ({{datos.meses}})</small> </th>

                     
    
                </tr>
            </thead>
    
            <tbody>   
    
                {% for i in datos.datos_unidades %}
                <tr class = "table-light">
                    <td style="width: 2%;"> <a href=" {% url 'Cotizador' i.0.id %}" style="color: rgb({{datos.proyecto.color}});"> <small> <b>{{i.0.piso_unidad}} - {{i.0.nombre_unidad}}</b> </small></a> </td>
                    
                    {% if i.0.tipo == "DEPARTAMENTO" %}
                    
                    <td style="width: 8%;"> <img src="{% static 'img/piso.png' %}" alt="" style="max-width:15px; height:auto; margin: 2px;"  > <small> <b>DEPTO</b> </small> </td>
                    
                    {% elif i.0.tipo == "LOCAL"%}

                    <td style="width: 8%;"> <img src="{% static 'img/tienda.png' %}" alt="" style="max-width:15px; height:auto; margin: 2px;"  > <small> <b>{{i.0.tipo}}</b> </small> </td>
                   
                    
                    
                    {% else %}

                    <td style="width: 8%;"> <img src="{% static 'img/coche.png' %}" alt="" style="max-width:15px; height:auto; margin: 2px;"  > <small> <b>{{i.0.tipo}}</b> </small> </td>
                   


                    {% endif %}
                    
                    <td style="width: 3%;"> <b> <small>{{i.0.tipologia}}</small> </b> </td>
                    <td style="width: 5%;"> <b> <small>{{i.1|floatformat:2}}m2</small></b> </td>
                    <td style="width: 5%;" class="priority-4"> <b> <small> {{i.0.asig}} </small> </b> </td>
                    
                    {% if i.9 != 0 and perms.ventas.view_ventasrealizadas %}

                    {% if i.0.estado == "DISPONIBLE" %}

                    <td style="width: 5%; color: #1CB433  ;"> <b> <small> <span class="hint--top hint--success" aria-label= " {% for d in i.9 %} {{d.tipo_venta}} el {{d.fecha}} a {{d.comprador}} {% endfor %}"> <b><u>{{i.0.estado}}</u></b></small> </b> </span> </td>
                    
                    {% elif i.0.estado == "SEÑADA" %}

                    <td style="width: 5%; color: #DADA1B ;"> <b> <small> <span class="hint--top hint--warning" aria-label= " {% for d in i.9 %} {{d.tipo_venta}} el {{d.fecha}} a {{d.comprador}} {% endfor %}"><b><u>{{i.0.estado}}</u></b></small> </b> </span> </td>
                             
                    {% else %}

                    <td style="width: 5%; "> <b> <small> <span class="hint--top hint--info" aria-label= " {% for d in i.9 %} {{d.tipo_venta}} el {{d.fecha}} a {{d.comprador}} {% endfor %}"><b><u>{{i.0.estado}}</u></b></small> </b> </span> </td>
                    
                    {% endif %}

                    {% else %}

                    {% if i.0.estado == "DISPONIBLE" %}

                    <td style="width: 5%; color: #1CB433  ;"> <b> <small> <b>{{i.0.estado}}</b> </small> </b> </td>

                    {% elif i.0.estado == "SEÑADA" %}

                    <td style="width: 5%; color: #DADA1B ;"> <b> <small> <b>{{i.0.estado}}</b> </small> </b> </td>
                    
                    {% else %}

                    <td style="width: 5%; "> <b> <small> <b>{{i.0.estado}}</b> </small> </b> </td>

                    {% endif %}

                    {% endif %}


                    {% if i.2 >= 0 %}
                    <td style="width: 5%;"> <b> <small>${{i.4|floatformat:0|intcomma}}</small> </b> </td>
                    <td style="width: 5%;"> <small><b>${{i.2|floatformat:0|intcomma}}</b> </small></td>
                    <td style="width: 5%;" class="priority-5"> <b> <small>${{i.5|floatformat:0|intcomma}}</small> </b> </td>
                    <td style="width: 5%;" class="priority-5"> <b> <small>${{i.6|floatformat:0|intcomma}}</small> </b> </td>
                    <td style="width: 5%;" class="priority-5"> <b> <small>${{i.7|floatformat:0|intcomma}}</small> </b> </td>
                    <td style="width: 5%;" class="priority-5"> <b> <small>${{i.8|floatformat:0|intcomma}}</small> </b> </td>
                    
                    {% else %}
    
                    <td style="width: 5%;"> <b> <small>{{i.4}}</small> </b> </td>
                    <td style="width: 5%;"> <b> <small>{{i.2}}</small> </b> </td>
                    <td style="width: 5%;" class="priority-5"> <b> <small>{{i.2}}</small> </b> </td>
                    <td style="width: 5%;" class="priority-5"> <b> <small>{{i.2}}</small> </b> </td>
                    <td style="width: 5%;" class="priority-5"> <b> <small>{{i.2}}</small> </b> </td>
                    <td style="width: 5%;" class="priority-5"> <b> <small>{{i.2}}</small> </b> </td>
    
                    {% endif %}
                    
                    
    
                </tr>
                {% endfor %}
            </tbody>
         
    
    
        </table>


    </div>

    



    {% endif %}

    {% if datos.mensaje == 1 %}

    <div style="text-align: center; margin-top: 10%;">
    
        <h6>No hay unidades que cumplan esas condiciones!</h6>
    
    </div>

    {% endif %}

    <div style="text-align: center; margin-top: 2rem;">
        <p> <small>-- Link<strong>P</strong> --</small> </p>

     </div>

                    
</div>


{% endif %}
 
    
{% endblock %}
